  \documentclass[oneside]{book}
%\documentclass[]{book}

\usepackage{lmodern}
\usepackage{setspace}
\setstretch{1.5}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{xltxtra,xunicode}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}


\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[a4paper, left=1.18in, right=1.18in, top=1.18in, bottom=0.787in]{geometry}
\usepackage[unicode=true]{hyperref}
\hypersetup{
            pdftitle={臺大論文模板},
            pdfauthor={廖永賦},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
% Fix footnotes in tables (requires footnote package)
\IfFileExists{footnote.sty}{\usepackage{footnote}\makesavenoteenv{long table}}{}
\let\oldhref=\href
% Make links footnotes instead of hotlinks:
\renewcommand{\href}[2]{#2\footnote{\url{#1}}}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\usepackage{pdfpages}
\usepackage{titlesec}
\usepackage{titletoc}
\usepackage{booktabs}
\usepackage{apptools}
\usepackage{float}
\usepackage[section]{placeins}

\usepackage[heading, fontset = none]{ctex}
\ctexset{appendix/name={\appendixname\space}}

\usepackage[fontsize=12pt]{scrextend}

% 如果想將每頁的頁碼置於中間下方，uncomment 下兩行
%\usepackage{fancyhdr}
%\pagestyle{fancy}

% Eng font-family
\setmainfont[
  Path=latex/,
  BoldFont={TimesNewRomanBold},
  ItalicFont={TimesNewRomanItalic},
  BoldItalicFont={TimesNewRomanBoldItalic}
]{TimesNewRoman}

% Trad Ch font-family
\setCJKmainfont[Path=latex/,AutoFakeBold=2.5,AutoFakeSlant=.3]{kaiti}
\setCJKmonofont[Path=latex/]{NotoSansMonoCJKtc}

% Special font: IPA
\newfontfamily{\ipa}[Path=latex/,AutoFakeBold=2.5,AutoFakeSlant=.3]{IPAfont} % Font for IPA symbols
\DeclareTextFontCommand{\ipatext}{\ipa}


%中文自動換行
\XeTeXlinebreaklocale "zh"
%文字的彈性間距
\XeTeXlinebreakskip = 0pt plus 1pt



\renewcommand{\figurename}{圖}
\renewcommand{\tablename}{表}
\renewcommand{\contentsname}{目錄}
\renewcommand{\listfigurename}{圖目錄}
\renewcommand{\listtablename}{表目錄}
\renewcommand{\appendixname}{附錄}
%\renewcommand{\bibname}{參考資料}

% deal with nuts floating figures
\renewcommand{\textfraction}{0.05}
\renewcommand{\topfraction}{0.8}
\renewcommand{\bottomfraction}{0.8}
\renewcommand{\floatpagefraction}{0.75}

\title{臺大論文模板}
\author{廖永賦}
\date{January 9, 2020}


\usepackage{fontspec}
%使用xeCJK，其他的還有CJK或是xCJK
\usepackage{xeCJK}
\usepackage{bm}

% Set the default fonts
% See https://tug.org/pipermail/xetex/2011-March/020226.html for fontspec
% % \setmainfont[
%   Path=latex/,
%   BoldFont={TimesNewRomanBold.ttf},
%   ItalicFont={TimesNewRomanItalic.ttf},
%   BoldItalicFont={TimesNewRomanBoldItalic.ttf}
% ]{TimesNewRoman.ttf}
% 
% %     \setCJKmainfont[Path=latex/,AutoFakeBold=2.5,AutoFakeSlant=.3]{kaiti}
%     \setCJKmonofont[Path=latex/]{NotoSansMonoCJKtc}
% 


% IPA support (Works with linguisticsdown)
% 

\usepackage{xcolor}
\usepackage{transparent}

\usepackage{tikz}
\usepackage[printwatermark]{xwatermark}
\newsavebox\mybox
\savebox\mybox{\tikz[]\node[opacity=0.2]{\includegraphics{watermark.png}};}
\newwatermark*[
  allpages,
  %angle=45,
  scale=0.18,
  xpos=6.3725cm,
  ypos=10.8225cm
]{\usebox\mybox}






\usepackage{amsthm}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}{Lemma}[chapter]
\newtheorem{corollary}{Corollary}[chapter]
\newtheorem{proposition}{Proposition}[chapter]
\newtheorem{conjecture}{Conjecture}[chapter]
\theoremstyle{definition}
\newtheorem{definition}{定義}[chapter]
\theoremstyle{definition}
\newtheorem{example}{例}[chapter]
\theoremstyle{definition}
\newtheorem{exercise}{Exercise}[chapter]
\theoremstyle{remark}
\newtheorem*{remark}{Remark}
\newtheorem*{solution}{Solution}
\let\BeginKnitrBlock\begin \let\EndKnitrBlock\end
\begin{document}


\includepdf[pages={1}, scale=1]{front_matter/front_matter.pdf}

\clearpage
\pagenumbering{roman}

\phantomsection
\addcontentsline{toc}{chapter}{口試委員會審定書}
%\pagenumbering{gobble}  % TEST REMOVE PAGENUM ==================================
\includepdf[pages={1}, scale=1]{certification-scan.pdf}


\phantomsection
\chapter*{誌謝}
非常感謝網路上各個默默耕耘開發 open source 專案的大大們。
非常感謝網路上各個默默耕耘開發 open source 專案的大大們。
非常感謝網路上各個默默耕耘開發 open source 專案的大大們。

沒有這些既存的資源，這份模板是不可能出現的。沒有這些既存的資源，這份模板是不可能出現的。沒有這些既存的資源，這份模板是不可能出現的。沒有這些既存的資源，這份模板是不可能出現的。
\addcontentsline{toc}{chapter}{誌謝}


\phantomsection
\chapter*{摘要}
摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。

摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。

新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。新段落要在前面空一行。

摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。

摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。摘要\textbf{第 1 行}開始而且不能是空行。
\bigbreak

\noindent
\textbf{關鍵字：} 第二行開始、R Markdown、Bookdown、可重製研究
\addcontentsline{toc}{chapter}{中文摘要}

\phantomsection
\chapter*{Abstract}
The first line of the abstract starts on \textbf{line 5} and must not be blank. The first line of the abstract starts on \textbf{line 5} and must not be blank. The first line of the abstract starts on \textbf{line 5} and must not be blank.

A new paragraph of the abstract. A new paragraph of the abstract. A new paragraph of the abstract. A new paragraph of the abstract. A new paragraph of the abstract. A new paragraph of the abstract.
\bigbreak

\noindent
\textbf{Keywords:} Line 2, R Markdown, Bookdown, Reproducible Research
\addcontentsline{toc}{chapter}{英文摘要}


{
\setcounter{tocdepth}{1}
\tableofcontents
%\phantomsection
%\addcontentsline{toc}{chapter}{\contentsname}
}

\newpage

\listoftables
\phantomsection
\addcontentsline{toc}{chapter}{\listtablename}
\newpage

\listoffigures
\phantomsection
\addcontentsline{toc}{chapter}{\listfigurename}
\newpage

% Set independent linestretch for code chunks
\let\oldShaded=\Shaded
\let\endoldShaded=\endShaded
\renewenvironment{Shaded}{
      \begin{spacing}{1}\begin{oldShaded}
    }
  {
  \end{oldShaded}
  \end{spacing}
  }

\clearpage
\pagenumbering{arabic}

\hypertarget{install}{%
\chapter{安裝}\label{install}}

\hypertarget{v1.0.0}{%
\subsection*{\texorpdfstring{\texttt{v1.0.0}}{v1.0.0}}\label{v1.0.0}}
\addcontentsline{toc}{subsection}{\texttt{v1.0.0}}

2019-02-10 之前已使用 \texttt{ntuthesis} 撰寫論文者，請下載 \texttt{v1.0.0}：

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#install.packages('remotes')}
\NormalTok{remotes}\OperatorTok{::}\KeywordTok{install_github}\NormalTok{(}\StringTok{"liao961120/ntuthesis@v1.0.0"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

並請閱讀\href{https://liao961120.github.io/ntuthesis/doc-v1}{第一版的說明文件}。

\hypertarget{ux6700ux65b0ux7248}{%
\subsection*{最新版}\label{ux6700ux65b0ux7248}}
\addcontentsline{toc}{subsection}{最新版}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{#install.packages('remotes')}
\NormalTok{remotes}\OperatorTok{::}\KeywordTok{install_github}\NormalTok{(}\StringTok{"liao961120/ntuthesis"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

安裝完成後，執行下方指令，下載套件所需的字體檔：

\begin{verbatim}
ntuthesis::download_fonts()
\end{verbatim}

新版的 \texttt{ntuthesis} 較易加入其它學校模板，目前正在開發中，API 與舊版兼容，但舊的 \texttt{ntu\_bookdown} 模板已更新為 \texttt{ntu}，並且不容於新版。已使用 \texttt{ntu\_bookdown} 模板者，請下載 \texttt{v1.0.0}。

\hypertarget{ide}{%
\section{IDE}\label{ide}}

建議使用 Rstudio，因為安裝 Rstudio 時，同時會安裝 Pandoc。若使用者使用 Rstudio 以外的 IDE，需要自行安裝並設定 Pandoc PATH，對使用者較為麻煩。

\hypertarget{latex}{%
\section{LaTeX}\label{latex}}

若已有管理、安裝 LaTeX 套件經驗者，可忽略。

\hypertarget{tinytex-ux5957ux4ef6}{%
\subsection{tinytex 套件}\label{tinytex-ux5957ux4ef6}}

若電腦尚未安裝 LaTeX，可安裝 R 的 tinytex 套件 (Mac 使用者可能會安裝失敗，見下文)：

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{install.packages}\NormalTok{(}\StringTok{'tinytex'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

接著，選擇\textbf{與電腦相同作業系統}的連結下載 TinyTeX Library\footnote{根據 Yihui 的說明 (\url{https://yihui.name/en/2018/08/tinytex-flash-drive})，TinyTex 具有可攜式（portable）的特性。}：

\begin{itemize}
\tightlist
\item
  \href{http://bit.ly/TinyTex-linux}{Linux x86\_64}
\item
  \href{http://bit.ly/TinyTeX-win}{Windows 7/10 64bit}
\item
  Mac 使用者在安裝 TinyTeX Library 時\textbf{很可能會遇到問題}。請跳過下方內容，直接從 \ref{mac} 節開始閱讀，幸運的話可以直接安裝成功。若失敗的話，可參考此二連結中的對話串：\href{https://github.com/yihui/tinytex/issues/92}{tinytex installation pain on Mac} 與 \href{https://github.com/yihui/tinytex/issues/24}{/usr/local/bin not writable}。
\end{itemize}

下載檔案後，

\begin{enumerate}
\def\labelenumi{\alph{enumi})}
\item
  將檔案解壓縮\footnote{Linux 使用者可用 \texttt{tar\ -zxvf\ tinytex-linux.tar.gz} 指令解壓縮。Windows 使用者可用 \href{https://www.developershome.com/7-zip/}{7-Zip} 解壓縮。}
\item
  將解壓後資料夾中的 \texttt{.TinyTeX/}\footnote{在 Windows 上是 \texttt{TinyTeX/}} 放至喜歡的路徑（e.g. \texttt{C:\textbackslash{}Users\textbackslash{}\textless{}username\textgreater{}\textbackslash{}.TinyTeX}, 路徑儘量簡單且\textbf{不能包含中文字}）
\item
  接著在 R 中執行：
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tinytex}\OperatorTok{::}\KeywordTok{use_tinytex}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

即會跳出一個視窗。請選擇剛剛存放 \texttt{.TinyTeX/} 的路徑。

若失敗詳見\href{https://yihui.name/en/2018/08/tinytex-flash-drive}{此篇文章}。

\hypertarget{tinytex-manage}{%
\subsubsection{LaTeX 套件管理}\label{tinytex-manage}}

在輸出 R Markdown 時，tinytex 會自動安裝缺少的 LaTeX 套件。因此，使用 TinyTeX 可以減輕管理 LaTeX 套件的麻煩。然而，下載 LaTeX 套件需要許多時間，因此這裡提供預先下載好之 TinyTeX（Windows 和 Linux）。

\hypertarget{mac}{%
\paragraph{Mac}\label{mac}}

由於作者沒有 Mac 電腦，無法提供 Mac 版本的 TinyTeX，Mac 使用者需使用

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tinytex}\OperatorTok{::}\KeywordTok{install_tinytex}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

安裝 TinyTeX，之後電腦在\protect\hyperlink{export-thesis}{輸出論文}時，會自動安裝所需的套件。

(若安裝失敗，請看看是否錯誤訊息與此二討論串中類似：\href{https://github.com/yihui/tinytex/issues/92}{tinytex installation pain on Mac}、\href{https://github.com/yihui/tinytex/issues/24}{/usr/local/bin not writable})

這會使得第一次輸出論文時會花費較多時間，然而，若願意的話，您可以將下載到您電腦上的 TinyTeX 提供給其他 Mac 使用者：

成功輸出論文 PDF 後，執行

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{tinytex}\OperatorTok{::}\KeywordTok{copy_tinytex}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

即會跳出一個新視窗。選擇資料夾後，即會將電腦上的 TinyTeX 複製到此資料夾。如此，下一位使用者只須將此資料夾複製到電腦上，並用 \texttt{tinytex::use\_tinytex()} 設定 TinyTeX 的路徑至該資料夾，即可節省輸出論文時安裝 LaTeX 套件所耗費的時間。
希望使用 Mac 成功輸出論文的使用者能將 TinyTeX 的壓縮檔或連結提供給我，讓其他的使用者受益。

\hypertarget{export-thesis}{%
\chapter{輸出論文}\label{export-thesis}}

\hypertarget{import-template}{%
\section{匯入論文模板}\label{import-template}}

在 console 執行：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ntuthesis}\OperatorTok{::}\KeywordTok{import_template}\NormalTok{(}\StringTok{"project_name"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

接著將該資料夾變更為 bookdown 專案（working dir 需為該專案資料夾）：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ntuthesis}\OperatorTok{::}\KeywordTok{init_proj}\NormalTok{()  }\CommentTok{# init working dir as proj.}
\end{Highlighting}
\end{Shaded}

詳細的檔案結構，見 \ref{dir-structure}。

\hypertarget{edit-front-matter}{%
\section{編輯封面}\label{edit-front-matter}}

在\texttt{\_person-info.yml}輸入個人資料後執行：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ntuthesis}\OperatorTok{::}\KeywordTok{comp_front}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

即會在 \texttt{front-matter/} 生成封面所需的檔案。以使用者的角度而言，除了 \texttt{front-matter/certification.pdf} 以外，不須理會 \texttt{front-matter/} 中的其它檔案。\texttt{certification.pdf} 是空白（未簽名）的「口試委員審定書」。

使用者可以將 \texttt{front-matter/certification.pdf} 列印出來。之後再將簽名過的「口試委員審定書」掃描成 PDF 並命名為 \texttt{certification-scan.pdf} ，取代專案資料夾\textbf{根目錄}中的同名檔案。

\hypertarget{compile-thesis}{%
\section{Compile 論文}\label{compile-thesis}}

使用 RStudio Build Pane 裡的 button 輸出論文：

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{figs/build-button} 

}

\caption{透過 RStudio 輸出論文}\label{fig:unnamed-chunk-2}
\end{figure}

或是在 console 執行下方指令：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bookdown}\OperatorTok{::}\KeywordTok{render_book}\NormalTok{(}\StringTok{"index.Rmd"}\NormalTok{, }\StringTok{"bookdown::gitbook"}\NormalTok{)}
\NormalTok{bookdown}\OperatorTok{::}\KeywordTok{render_book}\NormalTok{(}\StringTok{"index.Rmd"}\NormalTok{, }\StringTok{"bookdown::pdf_book"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

如此便會在 \texttt{\_book/} 中生成完整的論文（gitbook 和 PDF 格式）。

\hypertarget{write-thesis}{%
\chapter{論文撰寫}\label{write-thesis}}

\hypertarget{dir-structure}{%
\section{檔案結構}\label{dir-structure}}

執行以下指令後（詳見 \ref{import-template}）

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ntuthesis}\OperatorTok{::}\KeywordTok{import_template}\NormalTok{(}\StringTok{"project_name"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

即會匯入論文模板。以下是論文模板的檔案結構（已簡化）：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{├── project_name.Rmd     }\CommentTok{# Useless, please delete it}
\NormalTok{|}
\NormalTok{├── R/                   }\CommentTok{# code chunk root dir, put R scripts and data here}
\NormalTok{├── figs/                }\CommentTok{# Put figures to include in the thesis here}
\NormalTok{|}
\NormalTok{├── index.Rmd            }\CommentTok{# Book Layout (font, watermark, biblio, ...)}
\NormalTok{├── _acknowledge.Rmd     }\CommentTok{# acknowledgement}
\NormalTok{├── _abstract-en.Rmd     }\CommentTok{# abstract}
\NormalTok{├── _abstract-zh.Rmd     }\CommentTok{# Same as above, but in Chinese}
\NormalTok{|}
\NormalTok{├── 01-intro.Rmd         }\CommentTok{# Chapter 1 content}
\NormalTok{├── 02-literature.Rmd    }\CommentTok{# Chapter 2 content}
\NormalTok{├── 03-method.Rmd        }\CommentTok{# Chapter 3 content}
\NormalTok{├── 80-appx-help.Rmd     }\CommentTok{# Appendix Content}
\NormalTok{├── 99-references.Rmd    }\CommentTok{# Edit "References" Title}
\NormalTok{├── ref.bib              }\CommentTok{# References}
\NormalTok{├── cite-style.csl       }\CommentTok{# Citation style}
\NormalTok{|}
\NormalTok{├── _bookdown.yml        }\CommentTok{# label names in gitbook; Rmd files order}
\NormalTok{├── _output.yml          }\CommentTok{# preamble, pandoc args, cite-pkg}
\NormalTok{|}
\NormalTok{├── watermark.pdf        }\CommentTok{# 臺大浮水印 (PDF 右上角)}
\NormalTok{├── _person-info.yml      }\CommentTok{# Info to generate front matter}
\NormalTok{├── certification-scan.pdf  }\CommentTok{# 已簽名'口試委員審查書'}
\NormalTok{└── front_matter}
\NormalTok{    └── certification.pdf   }\CommentTok{# 空白'口試委員審查書'}
\end{Highlighting}
\end{Shaded}

\hypertarget{index-rmd}{%
\section{\texorpdfstring{\texttt{index.Rmd}}{index.Rmd}}\label{index-rmd}}

\texttt{index.Rmd} 是設定論文內文格式的地方，包含 yaml 以及 R setup code chunk。此模板將 code chunk 預設的 working directory 改成 \texttt{R/}\footnote{預設是 Rmd 檔所在的位置。}，如此較符合一般寫 Rscript 的邏輯\footnote{例如，使用相對路徑匯入資料時，一般會以 Rscript 所在的位置作為基準。}。若要更改此設定，至 setup code chunk 更改 \texttt{knitr::opts\_knit\$set(root.dir=\textquotesingle{}R\textquotesingle{})}。

\hypertarget{write-lang}{%
\section{撰寫語言}\label{write-lang}}

若使用\textbf{英文}撰寫論文，需修改 \texttt{\_output.yml}、\texttt{\_bookdown.yml} 這兩個檔案的內容。

\hypertarget{output.yml}{%
\subsection{\texorpdfstring{\texttt{\_output.yml}}{\_output.yml}}\label{output.yml}}

將 \texttt{in\_header:\ latex/preamble-zh.tex} 改為 \texttt{in\_header:\ latex/preamble-en.tex}：

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{bookdown:}\AttributeTok{:pdf_book:}
  \FunctionTok{includes:}
    \FunctionTok{in_header:}\AttributeTok{ latex/preamble-en.tex}
\end{Highlighting}
\end{Shaded}

\hypertarget{bookdown.yml}{%
\subsection{\texorpdfstring{\texttt{\_bookdown.yml}}{\_bookdown.yml}}\label{bookdown.yml}}

\texttt{\_bookdown.yml} 中，可以對標籤的名稱進行定義。這裡的設定與 PDF 輸出無關，只與 gitbook 輸出格式有關。因此，若無需使用 gitbook 輸出，可忽略此段。

此外，\texttt{\_bookdown.yml} 亦可設定 Rmd 檔在輸出文件中的順序。若無設定，就會依序檔名排序\footnote{此模板即未進行設定，因此第一章的內容寫在 \texttt{01-xxx.Rmd} 就會自動排在第一。而若檔名以底線開頭（\texttt{\_}）則會被忽略。更多內容詳見 \href{https://bookdown.org/yihui/bookdown/usage.html}{bookdown}。}。

在以下設定中，可使 gitbook 輸出的章節（順序）與 PDF 不同。

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rmd_files:}
  \FunctionTok{html:}\AttributeTok{ }\KeywordTok{[}\StringTok{"index.Rmd"}\KeywordTok{,} \StringTok{"abstract.Rmd"}\KeywordTok{,} \StringTok{"intro.Rmd"}\KeywordTok{]}
  \FunctionTok{latex:}\AttributeTok{ }\KeywordTok{[}\StringTok{"abstract.Rmd"}\KeywordTok{,} \StringTok{"intro.Rmd"}\KeywordTok{]}
\end{Highlighting}
\end{Shaded}

\hypertarget{bib-cite}{%
\section{文獻引用}\label{bib-cite}}

R Markdown 在文章中插入引用文獻的功能承繼 Pandoc。完整的使用見 \href{https://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html}{R Markdown 官方說明} 。

此模板目前產生文獻格式的方法是依靠 \href{https://github.com/jgm/pandoc-citeproc}{Pandoc citeproc}，因此，文獻格式是依據 \texttt{cite-style.csl}\footnote{此模板提供的 \texttt{cite-style.csl} 是 APA 英文第六版。此外，\url{http://blog.pulipuli.info/2011/05/zoteroapa.html} 亦有提供 APA 中文版的引用格式。需注意的是 Pandoc \textbf{不支援雙語 csl} (\url{http://blog.pulipuli.info/2014/08/zoteroapa-zotero-citation-style-apa.html})。} 產生的。使用者可至 \href{https://www.zotero.org/styles}{Zotero Style Repository} 下載所需的 csl 檔並覆蓋專案資料夾中的 \texttt{cite-style.csl}。

\hypertarget{ref-bib}{%
\subsection{\texorpdfstring{\texttt{ref.bib}}{ref.bib}}\label{ref-bib}}

\texttt{.bib} 檔的產生方式可以由 Endnote, Zotero, JabRef 等書目管理軟體匯出。匯出後，將檔名命名為 \texttt{ref.bib} 放在專案資料夾\footnote{或是可以自訂檔名，並到 \texttt{index.Rmd} yaml 中的 \texttt{bibliography:\ ref.bib} 更改 \texttt{ref.bib} 檔名。此外，亦可使用多個 \texttt{.bib} 檔：\texttt{bibliography:\ {[}ref1.bib,\ ref2.bib,\ ref3.bib{]}}。}。

\texttt{.bib} 內的一篇引用資料會類似：

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{@article}\NormalTok{\{}\OtherTok{leung2008}\NormalTok{,}
  \DataTypeTok{title}\NormalTok{ = \{Multicultural Experience Enhances Creativity: \{\{The\}\} When and How.\},}
  \DataTypeTok{volume}\NormalTok{ = \{63\},}
  \DataTypeTok{issn}\NormalTok{ = \{1935-990X(Electronic),0003-066X(Print)\},}
  \DataTypeTok{doi}\NormalTok{ = \{10.1037/0003-066X.63.3.169\},}
  \DataTypeTok{number}\NormalTok{ = \{3\},}
  \DataTypeTok{journaltitle}\NormalTok{ = \{American Psychologist\},}
  \DataTypeTok{date}\NormalTok{ = \{2008\},}
  \DataTypeTok{pages}\NormalTok{ = \{169-181\},}
  \DataTypeTok{keywords}\NormalTok{ = \{*Cognition,*Creativity,}
\NormalTok{    *Culture (Anthropological),}
\NormalTok{    *Experiences (Events),Multiculturalism\},}
  \DataTypeTok{author}\NormalTok{ = \{Leung, Angela Ka-yee and }
\NormalTok{    Maddux, William W. and }
\NormalTok{    Galinsky, Adam D. and Chiu, Chi-yue\}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

其中第一行的 \texttt{leung2008} 即為 citation key。透過 \texttt{@citekey}(\texttt{@leung2008})即可在文獻中插入 citation。匯出論文時，文末會自動產生引用的文獻。

\hypertarget{cite-syntax}{%
\subsection{引用語法}\label{cite-syntax}}

\href{https://github.com/crsh/citr}{\texttt{citr}} 是一個方便使用者插入引用文獻的 R 套件，讓使用者能透過 GUI 插入文獻：

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{figs/citr} 

}

\caption{使用 citr 套件插入引用文獻}\label{fig:unnamed-chunk-4}
\end{figure}

當需要更複雜的引用格式，如標示第幾頁，可以修改透過 \texttt{citr} 插入的語法：

\begin{itemize}
\tightlist
\item
  \texttt{Some\ text\ {[}@citekey{]}.}

  \begin{itemize}
  \tightlist
  \item
    Some text (Leung, Maddux, Galinsky, \& Chiu, \protect\hyperlink{ref-leung2008}{2008}).
  \end{itemize}
\item
  \texttt{@citekey\ Some\ text}

  \begin{itemize}
  \tightlist
  \item
    Leung et al. (\protect\hyperlink{ref-leung2008}{2008}) Some text
  \end{itemize}
\item
  \texttt{@citekey\ {[}p.\ 20{]}\ Some\ text.}

  \begin{itemize}
  \tightlist
  \item
    Leung et al. (\protect\hyperlink{ref-leung2008}{2008}, p. 20) Some text.
  \end{itemize}
\item
  \texttt{Some\ text\ {[}-@citekey{]}.}

  \begin{itemize}
  \tightlist
  \item
    Some text (\protect\hyperlink{ref-leung2008}{2008})
  \end{itemize}
\item
  \texttt{Some\ text\ {[}@citekey1;\ @citekey2{]}.}

  \begin{itemize}
  \tightlist
  \item
    Some text (Leung et al., \protect\hyperlink{ref-leung2008}{2008}; 黃宣範, \protect\hyperlink{ref-huangxuanfan1993}{1993}).
  \end{itemize}
\item
  Prefix \& Suffix

  \begin{itemize}
  \tightlist
  \item
    \texttt{Text\ {[}see\ @citekey1\ pp.45;\ also,\ @citekey2\ ch.\ 2{]}.}
  \item
    Text (see Leung et al., \protect\hyperlink{ref-leung2008}{2008}, p. 45; also, 黃宣範, \protect\hyperlink{ref-huangxuanfan1993}{1993} ch.~2).
  \end{itemize}
\end{itemize}

\hypertarget{ref-manager}{%
\subsection{書目管理軟體}\label{ref-manager}}

這裡建議使用 Zotero 加上 \href{https://retorque.re/zotero-better-bibtex/}{Better BibTeX} 擴充功能。\texttt{citr} 對 Zotero 有額外的支持，且 \textbf{Zotero 能夠控制 citation key 的格式}（例如，last name + year），但其它書目管理軟體如 Endnote 產生的 citation key 難以讀懂且無法更改格式。

\hypertarget{multi-lang-cite}{%
\subsection{多語言文獻引用}\label{multi-lang-cite}}

透過 csl 排版引用格式，只能支援單一語言。例如，若將英文格式套用到中文文獻，中文文獻就會出現英文的半形逗點和句點。

多語言的引用或許可透過 LaTeX 的引用套件達成，但由於作者本人對 LaTeX 不夠熟悉，目前尚未解決此問題。若您是 LaTeX 的高手，歡迎至附錄 \ref{latex-cite-pkg} 給我一些指教。

\hypertarget{cheatsheet}{%
\chapter{語法 Cheatsheet}\label{cheatsheet}}

下文許多內容直接自 \href{https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html}{Bookdown} 擷取。想完整了解者，請閱讀 Bookdown 中的內容。

\hypertarget{chapter-cross-ref}{%
\section{章節連結}\label{chapter-cross-ref}}

\hypertarget{define-anchor}{%
\subsection{錨點定義}\label{define-anchor}}

在內文中，可以使用特殊語法建立前往其它章節的連結，但首先每個章節需要有\textbf{錨點}。若章節標題由英數組成，例如 \texttt{\#\#\ Experimental\ Design}， 則錨點會自動被定義成 \texttt{experimental-design}。若\textbf{標題含有中文}，例如 \texttt{\#\#\ 實驗設計} 則需\textbf{自行定義錨點}：\texttt{\#\#\ 實驗設計\ \{\#exp-design\}}。

\hypertarget{ux5167ux6587ux9023ux7d50}{%
\subsection{內文連結}\label{ux5167ux6587ux9023ux7d50}}

要在內文建立連至其它章節的連結，需使用 \texttt{\textbackslash{}@ref(anchor)} 的語法，例如，

\begin{itemize}
\tightlist
\item
  連結至 \texttt{\#\#\ Experimental\ Design}

  \begin{itemize}
  \tightlist
  \item
    \texttt{\textbackslash{}@ref(experimental-design)}
  \end{itemize}
\item
  連結至 \texttt{\#\#\ 實驗設計\ \{\#exp-design\}}

  \begin{itemize}
  \tightlist
  \item
    \texttt{\textbackslash{}@ref(exp-design)}
  \end{itemize}
\end{itemize}

\hypertarget{math}{%
\section{數學}\label{math}}

\hypertarget{unnumbered-equations}{%
\subsection{Unnumbered Equations}\label{unnumbered-equations}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{\textbackslash{}begin}\NormalTok{\{}\ExtensionTok{equation*}\NormalTok{\}}\SpecialStringTok{ }
\SpecialCharTok{\textbackslash{}frac}\SpecialStringTok{\{d\}\{dx\}}\SpecialCharTok{\textbackslash{}left}\SpecialStringTok{( }\SpecialCharTok{\textbackslash{}int}\SpecialStringTok{_\{a\}^\{x\} f(u)}\SpecialCharTok{\textbackslash{},}\SpecialStringTok{du}\SpecialCharTok{\textbackslash{}right}\SpecialStringTok{)=f(x)}
\KeywordTok{\textbackslash{}end}\NormalTok{\{}\ExtensionTok{equation*}\NormalTok{\} }
\end{Highlighting}
\end{Shaded}

\begin{equation*} 
\frac{d}{dx}\left( \int_{a}^{x} f(u)\,du\right)=f(x)
\end{equation*}

\hypertarget{numbered-equations}{%
\subsection{Numbered Equations}\label{numbered-equations}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{\textbackslash{}begin}\NormalTok{\{}\ExtensionTok{equation}\NormalTok{\}}\SpecialStringTok{ }
\SpecialStringTok{  f}\SpecialCharTok{\textbackslash{}left}\SpecialStringTok{(k}\SpecialCharTok{\textbackslash{}right}\SpecialStringTok{) = }\SpecialCharTok{\textbackslash{}binom}\SpecialStringTok{\{n\}\{k\} p^k}\SpecialCharTok{\textbackslash{}left}\SpecialStringTok{(1-p}\SpecialCharTok{\textbackslash{}right}\SpecialStringTok{)^\{n-k\}}
\SpecialStringTok{  (}\SpecialCharTok{\textbackslash{}#}\SpecialStringTok{eq:bino)}
\KeywordTok{\textbackslash{}end}\NormalTok{\{}\ExtensionTok{equation}\NormalTok{\} }

\NormalTok{式 }\FunctionTok{\textbackslash{}@ref}\NormalTok{(eq:bino)}
\end{Highlighting}
\end{Shaded}

\begin{equation} 
  f\left(k\right) = \binom{n}{k} p^k\left(1-p\right)^{n-k}
  \label{eq:binom}
\end{equation}

式 \eqref{eq:binom}

\hypertarget{multi-line-aligned-equations}{%
\subsection{Multi-line Aligned Equations}\label{multi-line-aligned-equations}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{\textbackslash{}begin}\NormalTok{\{}\ExtensionTok{equation}\NormalTok{\}}\SpecialStringTok{ }
\KeywordTok{\textbackslash{}begin}\NormalTok{\{}\ExtensionTok{split}\NormalTok{\}}
\SpecialCharTok{\textbackslash{}mathrm}\SpecialStringTok{\{Var\}(}\SpecialCharTok{\textbackslash{}hat}\SpecialStringTok{\{}\SpecialCharTok{\textbackslash{}beta}\SpecialStringTok{\}) & =}\SpecialCharTok{\textbackslash{}mathrm}\SpecialStringTok{\{Var\}((X'X)^\{-1\}X'y)}\SpecialCharTok{\textbackslash{}\textbackslash{}}
\SpecialStringTok{ & =(X'X)^\{-1\}X'}\SpecialCharTok{\textbackslash{}mathrm}\SpecialStringTok{\{Var\}(y)((X'X)^\{-1\}X')'}\SpecialCharTok{\textbackslash{}\textbackslash{}}
\SpecialStringTok{ & =(X'X)^\{-1\}X'}\SpecialCharTok{\textbackslash{}mathrm}\SpecialStringTok{\{Var\}(y)X(X'X)^\{-1\}}\SpecialCharTok{\textbackslash{}\textbackslash{}}
\SpecialStringTok{ & =(X'X)^\{-1\}X'}\SpecialCharTok{\textbackslash{}sigma}\SpecialStringTok{^\{2\}IX(X'X)^\{-1\}}\SpecialCharTok{\textbackslash{}\textbackslash{}}
\SpecialStringTok{ & =(X'X)^\{-1\}}\SpecialCharTok{\textbackslash{}sigma}\SpecialStringTok{^\{2\}}
\KeywordTok{\textbackslash{}end}\NormalTok{\{}\SpecialStringTok{split\}}
\SpecialStringTok{(}\SpecialCharTok{\textbackslash{}#}\SpecialStringTok{eq:var-beta)}
\KeywordTok{\textbackslash{}end}\NormalTok{\{}\ExtensionTok{equation}\NormalTok{\}}

\NormalTok{詳見公式 }\FunctionTok{\textbackslash{}@ref}\NormalTok{(eq:var-beta)}
\end{Highlighting}
\end{Shaded}

\begin{equation} 
\begin{split}
\mathrm{Var}(\hat{\beta}) & =\mathrm{Var}((X'X)^{-1}X'y)\\
 & =(X'X)^{-1}X'\mathrm{Var}(y)((X'X)^{-1}X')'\\
 & =(X'X)^{-1}X'\mathrm{Var}(y)X(X'X)^{-1}\\
 & =(X'X)^{-1}X'\sigma^{2}IX(X'X)^{-1}\\
 & =(X'X)^{-1}\sigma^{2}
\end{split}
\label{eq:var-bet}
\end{equation}

詳見公式 \eqref{eq:var-bet}

\hypertarget{theorem-proof}{%
\subsection{定理與證明}\label{theorem-proof}}

\begin{Shaded}
\begin{Highlighting}[]
\BaseNTok{```\{theorem, thm-label, name="Pythagorean theorem"\}}
\BaseNTok{For a right triangle, if $c$ denotes the length of the hypotenuse}
\BaseNTok{and $a$ and $b$ denote the lengths of the other two sides, we have}

\BaseNTok{$$a^2 + b^2 = c^2$$}
\BaseNTok{```}

\NormalTok{詳見定理 \textbackslash{}@ref(thm:thm-label)}
\end{Highlighting}
\end{Shaded}

\BeginKnitrBlock{theorem}[Pythagorean theorem]
\protect\hypertarget{thm:pyth}{}{\label{thm:pyth} \iffalse (Pythagorean theorem) \fi{} }For a right triangle, if \(c\) denotes the length of the hypotenuse
and \(a\) and \(b\) denote the lengths of the other two sides, we have
\[a^2 + b^2 = c^2\]
\EndKnitrBlock{theorem}

詳見定理 \ref{thm:pyth}

\hypertarget{environment}{%
\subsection{環境}\label{environment}}

除了 \texttt{theorem} 之外，還可以使用其它 bookdown 提供的環境。例如，將 code chunk 中 \texttt{theorem} 換成 \texttt{proof}, \texttt{remark}, \texttt{solution}\footnote{\texttt{theorem}、\texttt{proof}、\texttt{remark} 這三者無法被 cross-reference。}。

表 \ref{tab:theorem-envs} 呈現 bookdown 中的\href{https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html\#tab:theorem-envs}{引用環境}。



\begin{table}

\caption{\label{tab:theorem-envs}Theorem environments in \textbf{bookdown}.}
\centering
\begin{tabular}[t]{lll}
\toprule
Environment & Printed Name & Label Prefix\\
\midrule
theorem & Theorem & thm\\
lemma & Lemma & lem\\
corollary & Corollary & cor\\
proposition & Proposition & prp\\
conjecture & Conjecture & cnj\\
\addlinespace
definition & Definition & def\\
example & Example & exm\\
exercise & Exercise & exr\\
\bottomrule
\end{tabular}
\end{table}

\hypertarget{figure-referencing}{%
\section{Figure Referencing}\label{figure-referencing}}

\begin{Shaded}
\begin{Highlighting}[]
\BaseNTok{```\{r iris, fig.cap= "The iris data."\}}
\BaseNTok{library(ggplot2)}
\BaseNTok{pl_iris <- ggplot(data = iris) +}
\BaseNTok{             geom_point(aes(x = Sepal.Length,}
\BaseNTok{                            y = Sepal.Width,}
\BaseNTok{                            color = Species)}
\BaseNTok{                        )}
\BaseNTok{pl_iris}
\BaseNTok{```}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics[width=0.7\linewidth]{ntu-bookdown_files/figure-latex/iris-1} 

}

\caption{The iris data.}\label{fig:iris}
\end{figure}

\texttt{見圖\ \textbackslash{}@ref(fig:iris)}產生：見圖 \ref{fig:iris}

\hypertarget{figure-caption}{%
\subsection{Figure Caption}\label{figure-caption}}

對於比較複雜的 caption，可以使用 Text reference 的方式：

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{對於比較複雜的 caption，可以使用 Text reference 的方式：}

\NormalTok{(ref:dia) 插入**引用資料** [@kassin2017] 的 Figure Caption.}

\BaseNTok{```\{r dia, fig.cap='(ref:dia)', fig.show='hold', out.width=c('48%','48%')\}}
\BaseNTok{ggplot(data = diamonds) +}
\BaseNTok{  geom_point(aes(x = carat, }
\BaseNTok{                 y = price,}
\BaseNTok{                 color = cut),}
\BaseNTok{             size = 0.1) +}
\BaseNTok{  guides(color = guide_legend(}
\BaseNTok{    override.aes = list(size = 2)}
\BaseNTok{    ))}

\BaseNTok{pl_iris # Second figure}
\BaseNTok{```}
\end{Highlighting}
\end{Shaded}



\begin{figure}

{\centering \includegraphics[width=0.48\linewidth]{ntu-bookdown_files/figure-latex/foo-1} \includegraphics[width=0.48\linewidth]{ntu-bookdown_files/figure-latex/foo-2} 

}

\caption{插入\textbf{引用資料} (Kassin, Fein, \& Markus, \protect\hyperlink{ref-kassin2017}{2017}) 的 Figure Caption.}\label{fig:foo}
\end{figure}

\hypertarget{table-referencing}{%
\section{Table Referencing}\label{table-referencing}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{(ref:mtcars) Dynamic variable in caption: }\BaseNTok{`r Sys.time()`}\NormalTok{.}

\BaseNTok{```\{r mtcars, echo=FALSE\}}
\BaseNTok{knitr::kable(}
\BaseNTok{  head(mtcars[, 1:8], 5), booktabs = TRUE,}
\BaseNTok{  caption = '(ref:mtcars)'}
\BaseNTok{  )}
\BaseNTok{```}

\FunctionTok{### Link Table in Later Sections \{-\}}
\NormalTok{見表 \textbackslash{}@ref(tab:mtcars)}
\end{Highlighting}
\end{Shaded}



\begin{table}

\caption{\label{tab:mtcar}Dynamic variable in caption: 2020-01-09 15:44:05.}
\centering
\begin{tabular}[t]{lrrrrrrrr}
\toprule
  & mpg & cyl & disp & hp & drat & wt & qsec & vs\\
\midrule
Mazda RX4 & 21 & 6 & 160 & 110 & 3.9 & 2.6 & 16 & 0\\
Mazda RX4 Wag & 21 & 6 & 160 & 110 & 3.9 & 2.9 & 17 & 0\\
Datsun 710 & 23 & 4 & 108 & 93 & 3.9 & 2.3 & 19 & 1\\
Hornet 4 Drive & 21 & 6 & 258 & 110 & 3.1 & 3.2 & 19 & 1\\
Hornet Sportabout & 19 & 8 & 360 & 175 & 3.1 & 3.4 & 17 & 0\\
\bottomrule
\end{tabular}
\end{table}

\hypertarget{link-table-in-later-sections}{%
\subsection*{Link Table in Later Sections}\label{link-table-in-later-sections}}
\addcontentsline{toc}{subsection}{Link Table in Later Sections}

見表 \ref{tab:mtcar}

\hypertarget{ux7e3dux6574ux7406}{%
\section{總整理}\label{ux7e3dux6574ux7406}}

\begin{itemize}
\tightlist
\item
  \texttt{\textbackslash{}@ref(section-anchor)}
\item
  \texttt{(ref:mtcar)\ Text\ refereces}
\item
  \texttt{\textbackslash{}@ref(fig:fig-label)}

  \begin{itemize}
  \tightlist
  \item
    \texttt{fig-label} is code chunk label
  \end{itemize}
\item
  \texttt{\textbackslash{}@ref(thm:thm-label)}

  \begin{itemize}
  \tightlist
  \item
    \texttt{thm-label} is code chunk label
  \end{itemize}
\item
  \texttt{\textbackslash{}@ref(tab:tab-label)}

  \begin{itemize}
  \tightlist
  \item
    \texttt{tab-label} is code chunk label. Use text reference for complicated captions.
  \end{itemize}
\item
  \texttt{\textbackslash{}@ref(eq:eq-label)}

  \begin{itemize}
  \tightlist
  \item
    Defined as \texttt{(\textbackslash{}\#eq:eq-label)} in LaTeX equation environment
  \end{itemize}
\end{itemize}

\hypertarget{add-on}{%
\chapter{進階功能擴充}\label{add-on}}

透過其它 R 套件，R Markdown 的撰寫過程能夠更順暢。以下介紹幾個例子，歡迎補充說明。

\hypertarget{ling}{%
\section{語言學}\label{ling}}

語言學相關文件寫作時，常需要插入 IPA 語音符號，但鍵盤通常難以直接打出這些符號。為此，我寫了一個 R 套件，讓使用者能直接在 RStudio 中透過輸入語音 features 的方式打出 IPA：

\begin{figure}

{\centering \includegraphics[width=1\linewidth]{figs/ipa} 

}

\caption{使用 linguisticsdown 套件插入 IPA 音標符號}\label{fig:unnamed-chunk-8}
\end{figure}

要使用這功能，需安裝 \texttt{linguisticsdown}：

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{install.packages}\NormalTok{(}\StringTok{"linguisticsdown"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

關於更詳細的功能，見\href{https://liao961120.github.io/linguisticsdown/}{套件網頁}

\hypertarget{feed-back}{%
\chapter*{問題協助}\label{feed-back}}
\addcontentsline{toc}{chapter}{問題協助}

\hypertarget{issue}{%
\section*{提出問題}\label{issue}}
\addcontentsline{toc}{section}{提出問題}

若使用此模板遇到困難不知如何解決，可以透過下列管道聯絡我（按優先順序排列）：

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  提出 \href{https://github.com/liao961120/ntuthesis/issues}{GitHub issue}（需有 GitHub 帳號）
\item
  直接在這份說明文件中\textbf{與問題相關的章節}留言（頁面最下方的 disqus 留言）
\item
  除非有特殊的原因，\textbf{請勿透過電子郵件提出問題}。公開自己的問題對其他人有很大的幫助，也能避免將時間浪費在重複回答相同的問題。
\end{enumerate}

\hypertarget{rmd-resources}{%
\section*{R Markdown 相關資源}\label{rmd-resources}}
\addcontentsline{toc}{section}{R Markdown 相關資源}

以下都是 R Markdown 相關的參考資源。與此論文模板最直接相關的是 \emph{Bookdown}。\emph{R Markdown: The Definitive Guide} 幾乎涵蓋了 R Markdown 的所有用途（例如，投影片製作）。Pandoc 則是 R Markdown 能夠支援多種輸出格式的關鍵，因為 R Markdown 的格式輸出是仰賴 Pandoc 模板（也是這個論文模板的製作方式）且 R Markdown 的 Markdown 語法即是 Pandoc Markdown 的語法。

\begin{itemize}
\item
  \href{https://bookdown.org/yihui/bookdown}{Bookdown}
\item
  \href{https://bookdown.org/yihui/rmarkdown}{R Markdown: The Definitive Guide}
\item
  \href{http://pandoc.org/MANUAL.html}{Pandoc User's Guide}
\end{itemize}

\hypertarget{improve-the-project}{%
\section*{Improve the Project}\label{improve-the-project}}
\addcontentsline{toc}{section}{Improve the Project}

最後，若您發現這份論文模板有錯誤或是可以改進的地方，同樣可以依上述的\protect\hyperlink{issue}{步驟}提出問題。甚至如果知道如何解決問題，歡迎直接提出 pull request。pull request 的範圍不限在模板本身。若您看到這份文件中有任何錯誤，可以直接透過 navbar 上的 修改文件。

\hypertarget{appendix-ux9644ux9304}{%
\appendix \addcontentsline{toc}{chapter}{\appendixname}}


\hypertarget{latex-cite-pkg}{%
\chapter{尋找 LaTeX 高手}\label{latex-cite-pkg}}

R Markdown 的 PDF 輸出是透過 Pandoc 的 LaTeX 模板，因此理論上 LaTeX 可以做到的事，也可以透過 R Markdown 達成。目前的問題是

\begin{quote}
LaTeX 本身並未有支援繁體中文格式的文獻引用套件
\end{quote}

經過一段時間的搜尋，發現 biblatex 套件似乎可以定義不同的引用格式\footnote{\url{https://tex.stackexchange.com/questions/417762/different-styles-between-citations-and-bibliography}}\footnote{\url{https://tex.stackexchange.com/questions/377308/different-citation-styles-for-the-same-bibliography}}，因此，或許可以透過定義新的標點符號，例如將原本引用格式中

\begin{itemize}
\tightlist
\item
  \texttt{,} 定義成 \texttt{，}
\item
  \texttt{.} 定義成 \texttt{。}
\end{itemize}

再透過 \texttt{.bib} 檔中的 \texttt{langid} field 辨識要使用何種引用格式。然而，由於作者本人對 LaTeX 並不熟悉，因此需要這方面熟手的協助。

\hypertarget{epilogue}{%
\chapter{後記}\label{epilogue}}

\begin{quote}
I have a dream that one day all students and researchers will forget what ``formatting a paper'' even means. I have a dream that one day journals and grad schools no longer have style guides. I have a dream that one day no missing \$ is inserted, and \textbackslash{}hbox is never overfull.

\hspace*{\fill}

--- \href{https://twitter.com/xieyihui/status/1022873179532996609}{Yihui Xie}
\end{quote}

R Markdown 的精神之一就是希望能免除使用者排版的困擾。在認識 R Markdown 的第一天後，我就希望未來（如果有機會的話）可以用 R Markdown 寫論文。但從第一次嘗試用 R Markdown 輸出中文 PDF 時，我就意識到這是一件麻煩事\footnote{這一切都起源於 LaTeX 的複雜度。}。換句話說，應該等不到有人幫我做出論文模板的一天。因此，自己就站在前輩們的肩膀上\footnote{包含 tzhuan/ntu-thesis (\url{https://github.com/tzhuan/ntu-thesis}) 的 XeLaTeX 台大論文模板、thesisdown (\url{https://github.com/ismayc/thesisdown}) 的啟發、Pandoc 以及 Bookdown 和 R Markdown 的生態系統。}，做出了這個論文模板。

\renewcommand{\href}{\oldhref}

\hypertarget{references}{%
\chapter*{參考資料}\label{references}}
\addcontentsline{toc}{chapter}{參考資料}

\hypertarget{refs}{}
\leavevmode\hypertarget{ref-kassin2017}{}%
Kassin, S., Fein, S., \& Markus, H. R. (2017). \emph{Social Psychology} (10th ed.). Boston: Cengage Learning.

\leavevmode\hypertarget{ref-leung2008}{}%
Leung, A. K.-y., Maddux, W. W., Galinsky, A. D., \& Chiu, C.-y. (2008). Multicultural experience enhances creativity: The when and how. \emph{American Psychologist}, \emph{63}(3), 169--181. \url{https://doi.org/10.1037/0003-066X.63.3.169}

\leavevmode\hypertarget{ref-huangxuanfan1993}{}%
黃宣範. (1993). \emph{語言、社會與族群意識: 臺灣語言社會學的研究}. 臺北市: 文鶴. Retrieved from \url{http://tulips.ntu.edu.tw:1081/record=b1285025*cht}







\end{document}
